import requests
import argparse


def check_http_get(url):
    response = requests.get(url, verify=False)
    return "404 Not Found" != response.text


def check_http_post(url, authorization_header):
    headers = {
        "Authorization": authorization_header,
    }
    response = requests.post(url, headers=headers, verify=False)
    return response.text.isalnum()


def main(target_ip):
    http_url = f"http://{target_ip}/%25"
    https_url = f"https://{target_ip}/webui/logoutconfirm.html?logon_hash=1%22"
    authorization_header = "0ff4fbf0ecffa77ce8d3852a29263e263838e9bb"

    http_get_result = check_http_get(http_url)
    https_get_result = check_http_get(https_url)
    https_post_result = check_http_post(http_url, authorization_header)
    http_post_result = check_http_post(https_url, authorization_header)
    if http_get_result or https_get_result or https_post_result or http_post_result:
        print(f"Target IP {target_ip} is 'Vulnerable'")
        if http_get_result or https_get_result:
            print("Suspicious 404 Not found")
        if https_post_result and http_post_result:
            print("Hexadecimal reply")

    else:
        print(f"Target IP {target_ip} is not 'Vulnerable'")


if __name__ == "__main__":
    parser = argparse.ArgumentParser()
    parser.add_argument("target_ip", help="Target IP address")
    args = parser.parse_args()
    main(args.target_ip)
